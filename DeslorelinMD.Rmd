---
title: "Effects of a GnRH agonist on giant pouched rat female sex behavior"
date: "`r Sys.Date()`"
author:
  - name: Beverly Lo
    email: blo
    corresponding_author: no
    affiliation:
      - Cornell
  - name: Bhupinder Singh
    email: bob@example.com
    affiliation: 
      - Vetschool
    footnote: 1 # Footnote using reference
  - name: Amit Hanandari-Levi
    email: cat@anotheru.edu
    affiliation: Cornell
    footnote:
        - 1
  - name: Jackie Berman
    email: cat@anotheru.edu
    affiliation: Cornell
  - name: Alexandra Chaves
    email: cat@anotheru.edu
    affiliation: Cornell
  - name: Aumena Choudhry
    email: cat@anotheru.edu
    affiliation: Cornell
  - name: Angela Freeman
    corresponding_author: yes
    affiliation: 
      - Cornell
      - Salisbury
  - name: Alexander Ophir
    affiliation: Cornell 
address:
  - code: Cornell
    address: Cornell University, Department of Psychology, Ithaca, NY, 14853
  - code: Vetschool
    address: Cornell University, Department of Veterinary Medicine, Ithaca, NY, 14853
  - code: Salisbury
    address: Salisbury University, Department of Biological Sciences, Salisbury, MD 21853
footnote:
  - code: 1
    text: "Equal contribution"
  - code: 2
    text: "Current email address: \\href{mailto:cat@example.com}{cat@example.com}"

abstract: |
  This is the abstract.

  It consists of two paragraphs.
acknowledgements: |
  This is an acknowledgement.

  It consists of two paragraphs.
keywords:
  - key
  - dictionary
  - word
fontsize: 10pt
#spacing: halfline # could also be oneline
#classoptions:
#  - endnotes
bibliography:  ./library.bib
#csl: apa.csl
#link-citations: yes
output: rticles::oup_article
#urlcolor: orange
#linkcolor: green
#citecolor: red
#header-includes:
#  - \usepackage[nomarkers,tablesfirst]{endfloat} # For figures and tables at end
#  - \usepackage{lineno} # For line numbering
#  - \linenumbers # For line numbering
---




```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
#setwd("/Users/afreeman/Desktop")
getwd()

#load all libraries
library(ade4)
library(ade4TkGUI)
library(ggplot2)
library(ggthemes)
library(lme4)
library(lmerTest)
library(emmeans)
library(car)
library(cowplot)
library(dbplyr)
library(dplyr)
library(broom)
library("ggpubr")



## Function for standard error
serr <- function(x) sqrt(var(x,na.rm=TRUE)/length(na.omit(x)))

##Theme for plots
theme_alex <- function(base_size=24, base_family ="Arial") {
  theme_few() %+replace%
    theme(axis.ticks = element_blank(), legend.title=element_text(size=24, face="bold"), 
          axis.title=element_text(size=24,face="bold"),
          axis.line = element_line(colour = "black"),
          panel.border = element_blank(),
          legend.position = "right")
  
}

COLOR1 <- "#D98DE9"
COLOR2 <- "#E9D98D"
```

# Introduction



## Methods

### Animals
 The animals used in this study included animals captured at our field site in Morogoro, Tanzania as adults, and their descendants that were born in our captive colony.
 
### Implantation
16 adult females were briefly anesthetized using isoflurane gas and then implanted with either a Deslorelin implant (n=8, Virbac,) or Vehicle implant (n=8 Virbac,) placed subcutaneously on the dorsal side of the animal just caudal to the shoulderblades and near the midline. All females were patent at the start of the experiment, except one that had reverted to non-patency one week prior to implantation. Animals were placed into two groups of 8 (4 Deslorelin and 4 Control in each group).

### Physical examination
We closely monitored vaginal patency of the female African giant pouched rats on a weekly
basis with visual inspection assisted by a periodontal probe when the female was under anesthesia.
We scored the measurements as either nonpatent (i.e., fused, with no opening in the skin), patent
(i.e., unfused, with opening in the skin), or patent closed (i.e., unfused, with partial opening in the
skin). While females were anesthetized, we weighed the rats and recorded nipple size and color.
Nipple size was measured using a wire gauge measuring tool that included numerical
measurements with decreasing diameter indicated by larger numbers. Nipple color was compared
to the body color and recorded as bright pink, medium pink, or pale pink (Figure 2).

### Behavior
Scentarking trials were completed before implantation while females were patent, and at week 2 and 6 (1 and 5 weeks post implantation, respectively). These dates were chosen to coincide with predicted changes in circulating estradiol.

Male choice tests were conducted near 6 months post implantation. 

## Results

#Patency
We detected no effect of GnRH agonist on patency after 6 months of treatment. 

# Nipples
We detected no effect of Deslorelin on nipple size

Deslorelin treatment did result in mass gain, as predicted.

# Scent marking
There was no effect of Deslorelin on the total investigation of the male mark, or on the number of scent marks or their size.

# Behavior in social choice test

Deslorelin treatment significantly impacted female behavior and male behavior towards the treated female.

```{r, echo=FALSE}

beverly <- read.csv("Beverlydata.csv")

AMITdata <-read.csv("BEVdata.csv")
#summary(AMITdata)
AMITdata$Trial <- as.factor(AMITdata$Trial)
AMITdata$Sex <- as.factor(AMITdata$Sex)
AMITdata$ID <- as.factor(AMITdata$ID)
AMITdata$Status <- as.factor(AMITdata$Status)
AMITdata$PercentAGG <- AMITdata$Aggression.dur/AMITdata$Total.time.w.male*100
AMITdata$PercentPOS <- AMITdata$Sniff.dur/AMITdata$Total.time.w.male*100

#Remove one trial where both females were saline-treated (human error)
AMITdata <-AMITdata[!(AMITdata$Trial=="1510959"),] 
```

```{r, echo=FALSE, warning = FALSE}
#head(beverly) #this will show you the first few lines to make sure it's loaded
#summary(beverly) #make sure there are all three timepoints, 13 pre, 16 week 2, 16 week 6

#The following are the linear models and anovas
beverly$ID <- as.factor(beverly$ID)

#sniffing duration
model.sniff <- lmer(Sniff_dur ~ Treatment*Timepoint +(1|ID), data=beverly)
summary(model.sniff)
anova(model.sniff)

#licking the scent
model.lick <- lmer(Lickscent_dur ~ Treatment*Timepoint +(1|ID), data=beverly)
summary(model.lick)
anova(model.lick)

#saliva/chewing area
model.salarea <- lmer(Saliva_area ~ Treatment*Timepoint +(1|ID), data=beverly)
summary(model.salarea)
anova(model.salarea)

#urine area
model.urarea <- lmer(Urine_area ~ Treatment*Timepoint +(1|ID), data=beverly)
summary(model.urarea)
anova(model.urarea)

#Anogenital rubbing
model.agrub <- lmer(AG_rubbing_dur~ Treatment*Timepoint +(1|ID), data=beverly)
summary(model.agrub)
anova(model.agrub)

#grooming duration
model.groom <- lmer(Groom_dur ~ Treatment*Timepoint +(1|ID), data=beverly)
summary(model.groom)
anova(model.groom)

#for count data, we use negative binomial distributions, 
#since these are not 'normal' distribution data
model.urcount <- glmer.nb(Urine_count ~ Treatment*Timepoint +(1|ID), data=beverly)
summary(model.urcount)
anova(model.urcount)

#this is for post-hoc testing

emmip(model.urcount,Treatment~Timepoint)
emmeans(model.urcount, pairwise~Treatment|Timepoint)

#for count data, we use negative binomial distributions, 
#since these are not 'normal' distribution data
model.salcount <- glmer.nb(Saliva_count ~ Treatment*Timepoint +(1|ID), data=beverly)
summary(model.salcount)
anova(model.salcount)

emmip(model.salcount,Treatment~Timepoint)
emmeans(model.salcount, pairwise~Treatment|Timepoint)

## make an investigation variable
beverly$investigate <- beverly$Lickscent_dur + beverly$Sniff_dur

#anova for investigation
model.invest <- lmer(investigate ~ Treatment*Timepoint +(1|ID), data=beverly)
summary(model.invest)
anova(model.invest)


## Following for boxplots
ggboxplot(beverly, x = "Timepoint", y = "investigate", 
          fill = "Treatment", palette = c("#ADD8E6", "#00688B"),
          lwd=1,
          ylab = "Duration of investigation (s)", xlab = "Timepoint")+
  theme_alex()


ggboxplot(beverly, x = "Timepoint", y = "Urine_area", 
          fill = "Treatment", palette = c("#ADD8E6", "#00688B"),
          lwd=1,
          ylab = "Area of urine mark (cm2)", xlab = "Timepoint")+
  theme_alex()


ggboxplot(beverly, x = "Timepoint", y = "Groom_dur", 
          fill = "Treatment", palette = c("#ADD8E6", "#00688B"),
          lwd=1,
          ylab = "Grooming duration (s)", xlab = "Timepoint")+
  theme_alex()


ggboxplot(beverly, x = "Timepoint", y = "Urine_count", 
          fill = "Treatment", palette = c("#ADD8E6", "#00688B"),
          lwd=1,
          ylab = "Urine marking counts", xlab = "Timepoint")+
  theme_alex()

ggboxplot(beverly, x = "Timepoint", y = "AG_rubbing_dur", 
          fill = "Treatment", palette = c("#ADD8E6", "#00688B"),
          lwd=1,
          ylab = "Anogenital rubbing duration (s)", xlab = "Timepoint")+
  theme_alex()

#following for line plots
ggplot(data = beverly, aes(x = Timepoint, y = investigate, group = ID, color = Treatment, fill=Treatment)) + 
  geom_line() + 
  geom_point(shape = 21, size = 3, color="black") + 
  xlab("Test Time") + 
  ylab("Investigation time (s)") + 
  scale_fill_manual(values = c("#ADD8E6", "#00688B")) +
  scale_color_manual(values = c("#ADD8E6", "#00688B")) +
  theme_alex()
ggsave("Investigation (sniff and lick).png", width=8, height=6, dpi=600)


ggplot(data = beverly, aes(x = Timepoint, y = Groom_dur, group = ID, color = Treatment, fill=Treatment)) + 
  geom_line() + 
  geom_point(shape = 21, size = 3, color="black") + 
  xlab("Test Time") + 
  ylab("Grooming duration (s)") + 
  scale_fill_manual(values = c("#ADD8E6", "#00688B")) +
  scale_color_manual(values = c("#ADD8E6", "#00688B")) +
  theme_alex()
ggsave("Self grooming.png", width=8, height=6, dpi=600)


ggplot(data = beverly, aes(x = Timepoint, y = Urine_area, group = ID, color = Treatment, fill=Treatment)) + 
  geom_line() + 
  geom_point(shape = 21, size = 3, color="black") + 
  xlab("Test Time") + 
  ylab("Urine area (cm2)") + 
  scale_fill_manual(values = c("#ADD8E6", "#00688B")) +
  scale_color_manual(values = c("#ADD8E6", "#00688B")) +
  theme_alex()
ggsave("Urine area.png", width=8, height=6, dpi=600)



ggplot(data = beverly, aes(x = Timepoint, y = Urine_count, group = ID, color = Treatment, fill=Treatment)) + 
  geom_line() + 
  geom_point(shape = 21, size = 3, color="black") + 
  xlab("Test Time") + 
  ylab("Urine mark counts") + 
  scale_fill_manual(values = c("#ADD8E6", "#00688B")) +
  scale_color_manual(values = c("#ADD8E6", "#00688B")) +
  theme_alex()
ggsave("Urine mark counts.png", width=8, height=6, dpi=600)

```



```{r, echo=FALSE, results="hide", warning=FALSE, message=FALSE}
### Statistics
#1. Examine whether treatment affected interaction.
Males <- AMITdata %>% filter(Sex=="M") #prevent double counting datapoints.

#Because each male was only in one trial, lmer and lm are equivalent.
fit1 <- lmer(Total.time.w.male ~ Status + (1|Trial), data=Males)
anova(fit1)
fit1a <- summary(fit1)
lm(Total.time.w.male ~ Status, data=Males)
InteractingAnova <- anova(lm(Total.time.w.male ~ Status, data=Males))

#2. Does status predict aggression time?
fit2 <- lmer(PercentAGG ~ Status * Sex + (1|Trial), data=AMITdata)
anova(fit2)
fit2.emm <- emmeans(fit2,  ~  Status*Sex)
#qqnorm(resid(fit2))
#qqline(resid(fit2))

#3. Does status predict sniffing time?
fit3 <- lmer(PercentPOS ~ Status * Sex + (1|Trial), data=AMITdata)
anova(fit3)
fit3.emm <- emmeans(fit3,  ~  Status*Sex)
#qqnorm(resid(fit3))
#qqline(resid(fit3))
```
*The time the male and Saline-treated female spent interacting together was greater than the time the male and Deslorelin-treated female spent together.*
Mean time spent interacting Deslorelin and male: Control and male: , t = `r round(fit1a$coefficients[2,4], digits= 3)`, p = `r round(fit1a$coefficients[2,5], digits= 4)`.
 however, this was no longer significant after corrections for multiple comparisons (adjusted $\alpha$ = 0.001)



```{r, echo=FALSE}



### First plot, Male aggression towards females ###
plotdata <- AMITdata %>% filter(ID=="Male") %>% group_by(Status) %>% mutate(meanagg = mean(Aggression.dur), stanaggerr = serr(Aggression.dur))  

aggplot1 <- ggplot(plotdata, aes(x=Status, y=Aggression.dur, fill= Status)) +
  scale_y_continuous(expand= c(0,0), limits = c(0, 40)) +
  #coord_cartesian(ylim = c(0, 10)) +
  geom_jitter(aes(color = (as.factor(Status))), size = 2, position=position_dodge(width=0.9), alpha=0.5) +
  geom_bar(aes(color = as.factor(Status)), alpha = .5,
           width=0.8,
           stat="summary", size = 1, position="dodge") +
  geom_errorbar(aes(ymin=meanagg-stanaggerr, ymax=meanagg+stanaggerr, color = as.factor(Status)), width=.4,
                position=position_dodge(.9)) +
  labs(x = "Implant Status", y="Male aggression towards females \n duration (s) ± SE")+ #Axes labels
  theme_alex() +
  scale_fill_manual(values=c(COLOR1, COLOR2)) + #colors in hexadecimal 
  scale_color_manual(values=c("Black", "Black")) + #colors in hexadecimal 
  # annotate("segment", x = 1, xend = 4, y = 40, yend = 40, colour = "black", size=1, alpha=1) +
  #annotate("text", x = 2.5, y = 41.5, size =6, label = "**") +
  #annotate("segment", x = 1, xend = 3, y = 35, yend = 35, colour = "black", size=1, alpha=1) +
  #annotate("text", x = 2, y = 36.5, size =6, label = "*") +
  guides(fill="none", color = "none") +
  theme(legend.title=element_text(size=8, face="bold"), 
        legend.text = element_text(size=8),
        axis.text = element_text(size=7, colour="black"),
        axis.title=element_text(size=8,face="bold"),
        axis.line = element_line(colour = "black"),
        panel.border = element_blank(),
        legend.position = "right"
  )
aggplot1 #show plot

##### How much did males spend sniffing females ###

plotdata2 <- AMITdata %>% filter(ID=="Male") %>% group_by(Status) %>% mutate(meansniff = mean(Sniff.dur), stanSnifferr = serr(Sniff.dur))  

sniffplot1 <- ggplot(plotdata2, aes(x=Status, y=Sniff.dur, fill= Status)) +
  scale_y_continuous(expand= c(0,0), limits = c(0, 250)) +
  #coord_cartesian(ylim = c(0, 10)) +
  geom_jitter(aes(color = (as.factor(Status))), size = 2, position=position_dodge(width=0.9), alpha=0.5) +
  geom_bar(aes(color = as.factor(Status)), alpha = .5,
           width=0.8,
           stat="summary", size = 1, position="dodge") +
  geom_errorbar(aes(ymin=meansniff-stanSnifferr, ymax=meansniff+stanSnifferr, color = as.factor(Status)), width=.4,
                position=position_dodge(.9)) +
  labs(x = "Implant Status", y="Male sniffing towards females \n duration (s) ± SE")+ #Axes labels
  theme_alex() +
  scale_fill_manual(values=c(COLOR1, COLOR2)) + #colors in hexadecimal 
  scale_color_manual(values=c("Black", "Black")) + #colors in hexadecimal 
  # annotate("segment", x = 1, xend = 4, y = 40, yend = 40, colour = "black", size=1, alpha=1) +
  #annotate("text", x = 2.5, y = 41.5, size =6, label = "**") +
  #annotate("segment", x = 1, xend = 3, y = 35, yend = 35, colour = "black", size=1, alpha=1) +
  #annotate("text", x = 2, y = 36.5, size =6, label = "*") +
  guides(fill="none", color = "none") +
  theme(legend.title=element_text(size=8, face="bold"), 
        legend.text = element_text(size=8),
        axis.text = element_text(size=7, colour="black"),
        axis.title=element_text(size=8,face="bold"),
        axis.line = element_line(colour = "black"),
        panel.border = element_blank(),
        legend.position = "right"
  )
sniffplot1 #show plot

### Association time ###

plotdataINTERACT <- AMITdata %>% filter(ID=="Male") %>% group_by(Status) %>% mutate(meaninteract = mean(Total.time.w.male), stanInteracterr = serr(Total.time.w.male))  

INTERACTplot <- ggplot(plotdataINTERACT, aes(x=Status, y=Total.time.w.male, fill= Status)) +
  scale_y_continuous(expand= c(0,0), limits = c(0, 1000)) +
  #coord_cartesian(ylim = c(0, 10)) +
  geom_jitter(aes(color = (as.factor(Status))), size = 2, position=position_dodge(width=0.9), alpha=0.5) +
  geom_bar(aes(color = as.factor(Status)), alpha = .5,
           width=0.8,
           stat="summary", size = 1, position="dodge") +
  geom_errorbar(aes(ymin=meaninteract-stanInteracterr, ymax=meaninteract+stanInteracterr, color = as.factor(Status)), width=.4,
                position=position_dodge(.9)) +
  labs(x = "Implant Status", y="Time spent interacting (s) ? SE")+ #Axes labels
  theme_alex() +
  scale_fill_manual(values=c(COLOR1, COLOR2)) + #colors in hexadecimal 
  scale_color_manual(values=c("Black", "Black")) + #colors in hexadecimal 
  # annotate("segment", x = 1, xend = 4, y = 40, yend = 40, colour = "black", size=1, alpha=1) +
  #annotate("text", x = 2.5, y = 41.5, size =6, label = "**") +
  #annotate("segment", x = 1, xend = 3, y = 35, yend = 35, colour = "black", size=1, alpha=1) +
  #annotate("text", x = 2, y = 36.5, size =6, label = "*") +
  guides(fill="none", color = "none") +
  theme(legend.title=element_text(size=8, face="bold"), 
        legend.text = element_text(size=8),
        axis.text = element_text(size=9, colour="black"),
        axis.title=element_text(size=9,face="bold"),
        axis.line = element_line(colour = "black"),
        panel.border = element_blank(),
        legend.position = "right"
  )
INTERACTplot #show plot
ggsave("Interaction Plot.png", width=4, height=4, dpi=600)

### Female Aggression ####
plotdataF1 <- AMITdata %>% filter(Sex=="F") %>% group_by(Status) %>% mutate(meanagg = mean(Aggression.dur), stanaggerr = serr(Aggression.dur))  

aggplot2 <- ggplot(plotdataF1, aes(x=Status, y=Aggression.dur, fill= Status)) +
  scale_y_continuous(expand= c(0,0), limits = c(0, 40)) +
  #coord_cartesian(ylim = c(0, 10)) +
  geom_jitter(aes(color = (as.factor(Status))), size = 2, position=position_dodge(width=0.9), alpha=0.5) +
  geom_bar(aes(color = as.factor(Status)), alpha = .5,
           width=0.8,
           stat="summary", size = 1, position="dodge") +
  geom_errorbar(aes(ymin=meanagg-stanaggerr, ymax=meanagg+stanaggerr, color = as.factor(Status)), width=.4,
                position=position_dodge(.9)) +
  labs(x = "Implant Status", y="Female aggression towards male \n duration (s) ± SE")+ #Axes labels
  theme_alex() +
  scale_fill_manual(values=c(COLOR1, COLOR2)) + #colors in hexadecimal 
  scale_color_manual(values=c("Black", "Black")) + #colors in hexadecimal 
  # annotate("segment", x = 1, xend = 4, y = 40, yend = 40, colour = "black", size=1, alpha=1) +
  #annotate("text", x = 2.5, y = 41.5, size =6, label = "**") +
  #annotate("segment", x = 1, xend = 3, y = 35, yend = 35, colour = "black", size=1, alpha=1) +
  #annotate("text", x = 2, y = 36.5, size =6, label = "*") +
  guides(fill="none", color = "none") +
  theme(legend.title=element_text(size=8, face="bold"), 
        legend.text = element_text(size=8),
        axis.text = element_text(size=7, colour="black"),
        axis.title=element_text(size=8,face="bold"),
        axis.line = element_line(colour = "black"),
        panel.border = element_blank(),
        legend.position = "right"
  )
aggplot2 #show plot

##Female Sniffing###

plotdataF2 <- AMITdata %>% filter(Sex=="F") %>% group_by(Status) %>% mutate(meansniff = mean(Sniff.dur), stanSnifferr = serr(Sniff.dur))  

sniffplotF1 <- ggplot(plotdataF2, aes(x=Status, y=Sniff.dur, fill= Status)) +
  scale_y_continuous(expand= c(0,0), limits = c(0, 250)) +
  #coord_cartesian(ylim = c(0, 10)) +
  geom_jitter(aes(color = (as.factor(Status))), size = 2, position=position_dodge(width=0.9), alpha=0.5) +
  geom_bar(aes(color = as.factor(Status)), alpha = .5,
           width=0.8,
           stat="summary", size = 1, position="dodge") +
  geom_errorbar(aes(ymin=meansniff-stanSnifferr, ymax=meansniff+stanSnifferr, color = as.factor(Status)), width=.4,
                position=position_dodge(.9)) +
  labs(x = "Implant Status", y="Female sniffing towards male \n duration (s) ± SE")+ #Axes labels
  theme_alex() +
  scale_fill_manual(values=c(COLOR1, COLOR2)) + #colors in hexadecimal 
  scale_color_manual(values=c("Black", "Black")) + #colors in hexadecimal 
  # annotate("segment", x = 1, xend = 4, y = 40, yend = 40, colour = "black", size=1, alpha=1) +
  #annotate("text", x = 2.5, y = 41.5, size =6, label = "**") +
  #annotate("segment", x = 1, xend = 3, y = 35, yend = 35, colour = "black", size=1, alpha=1) +
  #annotate("text", x = 2, y = 36.5, size =6, label = "*") +
  guides(fill="none", color = "none") +
  theme(legend.title=element_text(size=8, face="bold"), 
        legend.text = element_text(size=8),
        axis.text = element_text(size=7, colour="black"),
        axis.title=element_text(size=8,face="bold"),
        axis.line = element_line(colour = "black"),
        panel.border = element_blank(),
        legend.position = "right"
  )
sniffplotF1 #show plot

##
plot_grid(INTERACTplot, NULL, aggplot1, aggplot2, nrow=2, rel_widths = c(2, 2))
ggsave("Aggression Panel.png", width=8, height=3, dpi=600) #save panel locally

plot_grid(INTERACTplot, NULL, sniffplot1, sniffplotF1, nrow=2, rel_widths = c(2, 2))
ggsave("Sniff Panel.png", width=8, height=3, dpi=600) #save panel locally


### Percentage plots ##

plotPositive <- AMITdata %>% filter(Sex=="F") %>% group_by(Status) %>% mutate(mean1 = mean(PercentPOS), stanerr1 = serr(PercentPOS))  

plotPOS <- ggplot(plotPositive, aes(x=Status, y=PercentPOS, fill= Status)) +
  scale_y_continuous(expand= c(0,0), limits = c(0, 100)) +
  #coord_cartesian(ylim = c(0, 10)) +
  geom_jitter(aes(color = (as.factor(Status))), size = 2, position=position_dodge(width=0.9), alpha=0.5) +
  geom_bar(aes(color = as.factor(Status)), alpha = .5,
           width=0.8,
           stat="summary", size = 1, position="dodge") +
  geom_errorbar(aes(ymin=mean1-stanerr1, ymax=mean1+stanerr1, color = as.factor(Status)), width=.4,
                position=position_dodge(.9)) +
  labs(x = "Implant Status", y="Percent of Interaction time \n with female sniffing")+ #Axes labels
  theme_alex() +
  scale_fill_manual(values=c(COLOR1, COLOR2)) + #colors in hexadecimal 
  scale_color_manual(values=c("Black", "Black")) + #colors in hexadecimal 
  # annotate("segment", x = 1, xend = 4, y = 40, yend = 40, colour = "black", size=1, alpha=1) +
  #annotate("text", x = 2.5, y = 41.5, size =6, label = "**") +
  #annotate("segment", x = 1, xend = 3, y = 35, yend = 35, colour = "black", size=1, alpha=1) +
  #annotate("text", x = 2, y = 36.5, size =6, label = "*") +
  guides(fill="none", color = "none") +
  theme(legend.title=element_text(size=8, face="bold"), 
        legend.text = element_text(size=8),
        axis.text = element_text(size=7, colour="black"),
        axis.title=element_text(size=8,face="bold"),
        axis.line = element_line(colour = "black"),
        panel.border = element_blank(),
        legend.position = "right"
  )
plotPOS #show plot



plotAggressive <- AMITdata %>% filter(Sex=="F") %>% group_by(Status) %>% mutate(mean1 = mean(PercentAGG), stanerr1 = serr(PercentAGG))  

plotAGG <- ggplot(plotAggressive, aes(x=Status, y=PercentAGG, fill= Status)) +
  scale_y_continuous(expand= c(0,0), limits = c(0, 30)) +
  #coord_cartesian(ylim = c(0, 10)) +
  geom_jitter(aes(color = (as.factor(Status))), size = 2, position=position_dodge(width=0.9), alpha=0.5) +
  geom_bar(aes(color = as.factor(Status)), alpha = .5,
           width=0.8,
           stat="summary", size = 1, position="dodge") +
  geom_errorbar(aes(ymin=mean1-stanerr1, ymax=mean1+stanerr1, color = as.factor(Status)), width=.4,
                position=position_dodge(.9)) +
  labs(x = "Implant Status", y="Percent of Interaction time \n with female aggression")+ #Axes labels
  theme_alex() +
  scale_fill_manual(values=c(COLOR1, COLOR2)) + #colors in hexadecimal 
  scale_color_manual(values=c("Black", "Black")) + #colors in hexadecimal 
  # annotate("segment", x = 1, xend = 4, y = 40, yend = 40, colour = "black", size=1, alpha=1) +
  #annotate("text", x = 2.5, y = 41.5, size =6, label = "**") +
  #annotate("segment", x = 1, xend = 3, y = 35, yend = 35, colour = "black", size=1, alpha=1) +
  #annotate("text", x = 2, y = 36.5, size =6, label = "*") +
  guides(fill="none", color = "none") +
  theme(legend.title=element_text(size=8, face="bold"), 
        legend.text = element_text(size=8),
        axis.text = element_text(size=9, colour="black"),
        axis.title=element_text(size=9,face="bold"),
        axis.line = element_line(colour = "black"),
        panel.border = element_blank(),
        legend.position = "right"
  )
plotAGG #show plot
ggsave("Aggression Plot2.png", width=4, height=4, dpi=600) #save panel locally

### Percentage plots male ##


plotPositiveM <- AMITdata %>% filter(Sex=="M") %>% group_by(Status) %>% mutate(mean1 = mean(PercentPOS), stanerr1 = serr(PercentPOS))  

plotPOSM <- ggplot(plotPositiveM, aes(x=Status, y=PercentPOS, fill= Status)) +
  scale_y_continuous(expand= c(0,0), limits = c(0, 100)) +
  #coord_cartesian(ylim = c(0, 10)) +
  geom_jitter(aes(color = (as.factor(Status))), size = 2, position=position_dodge(width=0.9), alpha=0.5) +
  geom_bar(aes(color = as.factor(Status)), alpha = .5,
           width=0.8,
           stat="summary", size = 1, position="dodge") +
  geom_errorbar(aes(ymin=mean1-stanerr1, ymax=mean1+stanerr1, color = as.factor(Status)), width=.4,
                position=position_dodge(.9)) +
  labs(x = "Implant Status", y="Percent of Interaction time \n with male sniffing")+ #Axes labels
  theme_alex() +
  scale_fill_manual(values=c(COLOR1, COLOR2)) + #colors in hexadecimal 
  scale_color_manual(values=c("Black", "Black")) + #colors in hexadecimal 
  # annotate("segment", x = 1, xend = 4, y = 40, yend = 40, colour = "black", size=1, alpha=1) +
  #annotate("text", x = 2.5, y = 41.5, size =6, label = "**") +
  #annotate("segment", x = 1, xend = 3, y = 35, yend = 35, colour = "black", size=1, alpha=1) +
  #annotate("text", x = 2, y = 36.5, size =6, label = "*") +
  guides(fill="none", color = "none") +
  theme(legend.title=element_text(size=8, face="bold"), 
        legend.text = element_text(size=8),
        axis.text = element_text(size=7, colour="black"),
        axis.title=element_text(size=8,face="bold"),
        axis.line = element_line(colour = "black"),
        panel.border = element_blank(),
        legend.position = "right"
  )
plotPOSM #show plot



plotAggressiveM <- AMITdata %>% filter(Sex=="M") %>% group_by(Status) %>% mutate(mean1 = mean(PercentAGG), stanerr1 = serr(PercentAGG))  

plotAGGM <- ggplot(plotAggressiveM, aes(x=Status, y=PercentAGG, fill= Status)) +
  scale_y_continuous(expand= c(0,0), limits = c(0, 30)) +
  #coord_cartesian(ylim = c(0, 10)) +
  geom_jitter(aes(color = (as.factor(Status))), size = 2, position=position_dodge(width=0.9), alpha=0.5) +
  geom_bar(aes(color = as.factor(Status)), alpha = .5,
           width=0.8,
           stat="summary", size = 1, position="dodge") +
  geom_errorbar(aes(ymin=mean1-stanerr1, ymax=mean1+stanerr1, color = as.factor(Status)), width=.4,
                position=position_dodge(.9)) +
  labs(x = "Implant Status", y="Percent of Interaction time \n with male aggression")+ #Axes labels
  theme_alex() +
  scale_fill_manual(values=c(COLOR1, COLOR2)) + #colors in hexadecimal 
  scale_color_manual(values=c("Black", "Black")) + #colors in hexadecimal 
  # annotate("segment", x = 1, xend = 4, y = 40, yend = 40, colour = "black", size=1, alpha=1) +
  #annotate("text", x = 2.5, y = 41.5, size =6, label = "**") +
  #annotate("segment", x = 1, xend = 3, y = 35, yend = 35, colour = "black", size=1, alpha=1) +
  #annotate("text", x = 2, y = 36.5, size =6, label = "*") +
  guides(fill="none", color = "none") +
  theme(legend.title=element_text(size=8, face="bold"), 
        legend.text = element_text(size=8),
        axis.text = element_text(size=9, colour="black"),
        axis.title=element_text(size=9,face="bold"),
        axis.line = element_line(colour = "black"),
        panel.border = element_blank(),
        legend.position = "right"
  )
plotAGGM #show plot
ggsave("Aggression Panel percent2.png", width=4, height=4, dpi=600)

plot_grid(INTERACTplot, NULL, plotAGG, plotAGGM, nrow=2, rel_widths = c(2, 2))
ggsave("Aggression Panel percent.png", width=8, height=3, dpi=600) #save panel locally

plot_grid(INTERACTplot, NULL, plotPOS, plotPOSM, nrow=2, rel_widths = c(2, 2))
ggsave("Sniff Panel percent.png", width=8, height=3, dpi=600) #save panel locally



```



## Discussion

# References
